HDFS_PORT=9000

PREVIOUS_HDFS_DIR_USER_FILTERED=hdfs://${MORPHL_SERVER_IP_ADDRESS}:${HDFS_PORT}/${PREVIOUS_PREDICTION_DAY_AS_STR}_${UNIQUE_HASH}_ga_epnau_filtered
PREVIOUS_HDFS_DIR_SESSION_FILTERED=hdfs://${MORPHL_SERVER_IP_ADDRESS}:${HDFS_PORT}/${PREVIOUS_PREDICTION_DAY_AS_STR}_${UNIQUE_HASH}_ga_epnas_filtered
PREVIOUS_HDFS_DIR_HIT_FILTERED=hdfs://${MORPHL_SERVER_IP_ADDRESS}:${HDFS_PORT}/${PREVIOUS_PREDICTION_DAY_AS_STR}_${UNIQUE_HASH}_ga_epnah_filtered

hdfs dfs -test -e ${PREVIOUS_HDFS_DIR_USER_FILTERED} ${PREVIOUS_HDFS_DIR_SESSION_FILTERED} ${PREVIOUS_HDFS_DIR_HIT_FILTERED}

if [ $? -eq 0 ]; then
    hdfs dfs -rm ${PREVIOUS_HDFS_DIR_USER_FILTERED}/*
    hdfs dfs -rmdir ${PREVIOUS_HDFS_DIR_USER_FILTERED}

    hdfs dfs -rm ${PREVIOUS_HDFS_DIR_SESSION_FILTERED}/*
    hdfs dfs -rmdir ${PREVIOUS_HDFS_DIR_SESSION_FILTERED}

    hdfs dfs -rm ${PREVIOUS_HDFS_DIR_HIT_FILTERED}/*
    hdfs dfs -rmdir ${PREVIOUS_HDFS_DIR_HIT_FILTERED}

    exit 0
fi


CURRENT_HDFS_DIR_USER_FILTERED=hdfs://${MORPHL_SERVER_IP_ADDRESS}:${HDFS_PORT}/${CURRENT_PREDICTION_DAY_AS_STR}_${UNIQUE_HASH}_ga_epnau_filtered
CURRENT_HDFS_DIR_SESSION_FILTERED=hdfs://${MORPHL_SERVER_IP_ADDRESS}:${HDFS_PORT}/${CURRENT_PREDICTION_DAY_AS_STR}_${UNIQUE_HASH}_ga_epnas_filtered
CURRENT_HDFS_DIR_HIT_FILTERED=hdfs://${MORPHL_SERVER_IP_ADDRESS}:${HDFS_PORT}/${CURRENT_PREDICTION_DAY_AS_STR}_${UNIQUE_HASH}_ga_epnah_filtered

hdfs dfs -test -e ${CURRENT_HDFS_DIR_USER_FILTERED} ${CURRENT_HDFS_DIR_SESSION_FILTERED} ${CURRENT_HDFS_DIR_HIT_FILTERED}


if [ $? -eq 0 ]; then
    hdfs dfs -rm ${CURRENT_HDFS_DIR_USER_FILTERED}/*
    hdfs dfs -rmdir ${CURRENT_HDFS_DIR_USER_FILTERED}

    hdfs dfs -rm ${CURRENT_HDFS_DIR_SESSION_FILTERED}/*
    hdfs dfs -rmdir ${CURRENT_HDFS_DIR_SESSION_FILTERED}

    hdfs dfs -rm ${CURRENT_HDFS_DIR_HIT_FILTERED}/*
    hdfs dfs -rmdir ${CURRENT_HDFS_DIR_HIT_FILTERED}

    exit 0
fi

exit 0